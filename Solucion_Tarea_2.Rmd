---
title: "Solución Tarea 2"
author: "Integrantes: María Fernanda Villalobos Barboza B78304, \nRicardo Huapaya Rey B83936, \nSebasthián Valverde Martínez B98083, \nSebastian Mora Rojas B95205\n"
date: '`r format(Sys.Date(), "%d %b, %Y")`'
output:
  html_document: default
  word_document: default
theme: "journal"
---

```{r setup, echo=FALSE, results='hide', message=FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(readxl)
library(dplyr)
library(stargazer)
library(normtest)
library(skedastic)

setwd("C:/Users/FamiliaFeliz/Documents/GitHub/Tarea_1_Econometria")

cigs = read_excel("Data/CigarettesB.xlsx")

energy = read_excel("Data/Electricity1970.xlsx")

datos_reg <- select(energy, Costo= ln_COST, Produccion = ln_output, Trabajo= ln_labor,
                Capital= ln_capital, Combustible= fuel    )
```


En este presente documento se procede a realizar un análisis econométrico de diversas bases de datos de interés. Para ello se selecionaron las bases:

-   2.2 CigarettesB: Cigarette Consumption Data

-   2.6 Electricity1970: Cost Function of Electricity Producers 1970

-   2.7 EuroEnergy: European Energy Consumption Data.

La estructura del documento es de un análisis individual en el orden mencionado previamente. Para así al final discutir en una última sección las conclusiones de cada análisis. El codigo del codigo se encuentra en el siguiente [repositorio](https://github.com/ricardohuapaya/Tarea_1_Econometria).

## 1. Análisis Cigarettes Data

Para la base de datos 2.2 tomaremos la variable `PACKS` como nuestra variable dependiente que será analizada. Esta variable representa el número de paquetes consumidos por personas mayores de 16 años en casa Estado; así nuestro modelo propuesto para el primer análisis sería de la forma:

$$
ln(PACKS) = \beta_{0}+\beta_{1}ln(price)+\beta_{2}ln(income)+\mu
$$

### 1.1 Resumen Información


Realizamos un análisis gráfico para nuestras 3 variables: ``PACKS``, ``income`` y ``price``; se puede apreciar en el siguiente gráfico que existe cierto nivel de correlación negativa entre el consumo y el precio. 

```{r, echo = FALSE}
ggplot( data = cigs, 
        mapping = aes(
          x = price,
          y = PACKS
      )) + geom_point(color = "red") +
  labs( title = "Consumo de Cigarros y Precio",
        subtitle = "Escala Logarítmica",
        x = "Precio",
        y = "Paquetes de cigarrillos consumidos"
  )+theme_grey() + scale_radius(3)

```

Por otra parte, note que si realizamos un gráfico similar al previo donde comparamos el ingreso medio por estado con el consumo medio por persona en cada estado, se infiere que no existe una correlación entre ambas variables. 

```{r, echo=FALSE}
ggplot( data = cigs, 
        mapping = aes(
          x = income,
          y = PACKS
      )) + geom_point(color = "red") +
  labs( title = "Consumo de Cigarros e Ingreso",
        subtitle = "Escala Logarítmica",
        x = "Ingreso",
        y = "Paquetes de cigarrillos consumidos"
  )+theme_grey() + scale_radius(3)
```

Haciendo un análisis de correlación propiamente entre la variable ``PACKS`` y cada una de sus variables explicativas nos da un resultado similar a la intuición grafica. El resultado matemático indica que existe una correlación negativa débil entre ingreso y la cantidad de cigarros consumidos.

```{r, echo=FALSE}
round(cor(cigs), 2)
```


### 1.2 Regresión Lineal

Con el fin de analizar la regresión lineal de nuestras variables, utilizaremos el siguiente código:

```{r, warning = FALSE}
linear.cigs <-lm(PACKS ~ price+income, data=cigs)
```

El cual nos muestra que en promedio se consumiría $4.3$ paquetes de cigarillos si el precio y los ingresos fueran $0$. En este otro caso note que dada la definición del modelo $\beta_{1}$ es un indicador de Elasticidad precio de la demanda de cigarrillos. Considere que al ser mayor a uno no sigue la intuición económica incial que los cigarrillos son ineslásticos. 


```{r, echo=FALSE, warning=FALSE}
stargazer(linear.cigs, type = "text", title = "Cuadro #1: Resultados Regresión")
coef = coefficients(linear.cigs)
```

### 1.3 Pruebas t
Utilizando la misma función que en la pregunta anterior, y con el cuadro 1 se obtiene la información necesaria para obtener los resultados de la prueba $t$.

Tomando $H_{0}:  \beta_{1}=0$ (Precio no tiene efecto en consumo) La prueba $t$ realizada para el precio nos devuelve un P-value de 0.000168, entonces con un nivel de significancia del 5% podemos rechazar la hipotesis nula donde el precio del paquete no afecta el consumo. 

Tomando $H_{0}:  \beta_{2}=0$  (Ingreso no tiene efecto en consumo) La prueba t realizada para el ingreso nos devuelve un P-Value de 0.386 el cual, entonces con un nivel de significancia del 5% podemos no podemos rechazar la hipotesis nula donde el precio del paquete no afecta el consumo. 

### 1.4 Pruebas F
Utilizando la misma función que en la pregunta anterior, y con el cuadro 1 se obtiene la información necesaria para obtener los resultados de la prueba $f$.
Tomando una prueba de significancia conjunta tal que nuestra hipotesis nula sea; $H_{0}:  \beta_{1}= \beta_{2}=0$.
La prueba $f$ conjunta nos devuelve un P-value de 0.0004168, entonces con un nivel de significancia del 5% se rechaza la hipotesis nula conjunta de que el precio y el ingreso no afectan el consumo.




## 2. Analisis Energy

Para la base de datos 2.6 tomaremos el la variable `Costo` como nuestra variable dependiente que será analizada. Esta variable representa el costo en dolares por cada mil kwh. Las variables explicativas tomadas son el salario promedio de la firma, el indice de capital, el precio de combustible y el output final en millones de kwh.
A partir de estas variables, la regresión sera calculada con los logaritmos naturales de las variables costo, producción, trabajo y capital

$$
ln(Costo) = \beta_{0}+ \beta_{1}ln(producción)+\beta_{2}ln(trabajo)+\beta_{3}ln(capital)+\beta_{4}combustible +\mu
$$

### 2.1 Regresión Lineal

Con el fin de analizar la regresión lineal de nuestras variables, utilizaremos el siguiente codigo:

```{r, warning = FALSE}
datos_reg 
linear.energy <- lm( Costo ~ Produccion + Trabajo + Capital + Combustible, data= datos_reg)
```

```{r, echo=FALSE, warning=FALSE}
stargazer(linear.energy, type = "text", title = "Cuadro #2: Resultados Regresión")
coef = coefficients(linear.energy)
```

Con todo lo demas constante se pueden realizar las siguientes interpretacions de los coeficientes 
Para el $\beta_{1}$ se interpreta como la elasticidad del costo a producción, si la producción incrementa en 1% se espera que los costos aumenten en 0.84%
Para el $\beta_{3}$ se interpreta como la elasticidad del costo a capital, si el capital incrementa en 1% se espera que los costos aumenten en 0.18%
Para el $\beta_{4}$ se interpreta como la semielasticidad del costo respecto al combustible, si la producción incrementa en un dolar se espera que los costos aumenten en 0.023%


### 2.2 Pruebas t
Utilizando la misma función que en la pregunta anterior, y con el cuadro 2 se obtiene la información necesaria para obtener los resultados de la prueba $t$.
Tomando $H_{0}:  \beta_{1}=0$ (Producción no tiene efecto en los Costos) La prueba $t$ realizada para la producción nos devuelve un P-value que tiende a 0, entonces con un nivel de significancia del 5% podemos rechazar la hipotesis nula donde la producción no afecta los costos. 

Tomando $H_{0}:  \beta_{2}=0$  (Trabajo no tiene efecto en los Costos) La prueba $t$ realizada para la producción nos devuelve un P-value de 0.7515, entonces no se se puede rechazar la hipotesis nula, por lo tanto el trabajo no tiene efecto sobre los costos.   

Tomando $H_{0}:  \beta_{3}=0$ (Capital no tiene efecto en los Costos) La prueba $t$ realizada para la producción nos devuelve un P-value de 0.0496, entonces con un nivel de significancia del 5% podemos rechazar la hipotesis nula donde el capital no afecta los costos.

Tomando $H_{0}:  \beta_{4}=0$  (Combustible no tiene efecto en los Costos) La prueba $t$ realizada para la producción nos devuelve un P-value que tiende a 0, entonces con un nivel de significancia del 5% podemos rechazar la hipotesis nula donde la producción no afecta los costos.

### 2.3 Prueba F
Utilizando la misma función que en la pregunta anterior, y con el cuadro 2 se obtiene la información necesaria para obtener los resultados de la prueba F.
Tomando una prueba de significancia conjunta tal que nuestra hipotesis nula sea; $H_{0}:  \beta_{1}= \beta_{2}=\beta_{3}= \beta_{4}=0$.
La prueba F conjunta nos devuelve un P-value que tiende a 0, entonces con un nivel de significancia del 5% se rechaza la hipotesis nula conjunta de que los B´s no afectan los costos.


Interpretando la prueba F de significancia conjunta del modelo con la función summary donde la Ho: B´s(en conjunto)= 0 se puede afirmar que 
los coeficientes de las variables explicativas no son 0 ya que el p-value asociado a la prueba es practicamente 0.

### 2.4 Pruebas 
Prueba de normalidad Jarque-Bera para observar si existe normalidad de los residuos 
```{r, include=FALSE}
residuos_linear.energy<-resid(linear.energy)

```

```{r, echo=FALSE }
jb.norm.test(residuos_linear.energy)
hist(residuos_linear.energy)
```

A partir del histograma de los residuos de la regresión y el estadístico JB se puede observar que los residuos no se distribuyen normalmente, el p-value asociado a la prueba tiende a 0 por lo que se rechaza la Ho de que los residuos se distribuyen normalmente.


Prueba de heterocedasticidad de White para observar si existe homocedasticidad de los términos de error $u_{i}$

```{r, echo=FALSE}
white_lm(linear.energy, interactions = FALSE)
```

A partir de la prueba de White sin terminos cruzados se obtiene un p-value que tiende a 0 por lo que se rechaza la $H_{0}$ y si existe evidencia de heterocedasticidad
















## 3. Analisis Euroenergy
