---
title: "Solución Tarea 1"
author: "Integrantes: "
date: '`r format(Sys.Date(), "%d %b, %Y")`'
output:
  html_document: default
  word_document: default
theme: "journal"
---

```{r setup, echo=FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(ggplot2)
library(readxl)
library(stargazer)

setwd("~/UCR/Tarea_1_Econometria")

cigs = read_excel("Data/CigarettesB.xlsx")

energy = read_excel("Data/Electricity1970.xlsx")

euroenergy = read_excel("Data/EuroEnergy.xlsx")
```

# Solución de Tarea 1

En este presente documento se procede a realizar un analisis econometrico de diversas bases de datos de interes. Para ello se selecionaron las bases:

-   2.2 CigarettesB: Cigarette Consumption Data

-   2.6 Electricity1970: Cost Function of Electricity Producers 1970

-   2.7 EuroEnergy: European Energy Consumption Data.

La estructura del documento es de un analisis individual en el orden mencionado previemente. Para así al final discutir en una última sección las conclusones de cada analisis.

## 1. Analisis Cigarettes Data

Para la base de datos 2.2 tomaremos la variable `PACKS` como la variable dependiente que será analizada. Esta variable representa el numero de paquetes consumidos por personas mayores de 16 años.

### 1.1 Resumen Información

```{r, echo=FALSE}

stargazer(as.data.frame(cigs[c("PACKS","price","income")]), 
          type = "text", 
          title = "Cuadro #: Resumen Cigarrattes")
```

Realizando un analisis grafico de nuestras 3 variables: "PACKS", "income" y "price" se puede ver que existe cierto nivel de correlación negativa entre el consumo y el precio. Asi mismo, se puede observar una leve correlacion positiva entre el ingreso disponible per capita y el precio de los cigarillos en el estado.

```{r}
ggplot( data = cigs, 
        mapping = aes(
          x = price,
          y = PACKS
      )) + geom_point(color = "red") +
  labs( title = "Consumo de Cigarros y Precio",
        subtitle = "Escala Logaritmitca",
        x = "Precio",
        y = "Paquetes de cigarrillos consumidos"
  )+theme_grey() + scale_radius(3)

```

```{r}
ggplot( data = cigs, 
        mapping = aes(
          x = income,
          y = PACKS
      )) + geom_point(color = "red") +
  labs( title = "Consumo de Cigarros e Ingreso",
        subtitle = "Escala Logaritmitca",
        x = "Ingreso",
        y = "Paquetes de cigarrillos consumidos"
  )+theme_grey() + scale_radius(3)
```

Haciendo un analisis de correlacion entre la variable PACKS y cada una de sus variables explicativas nos da un resultado de:

```{r}
cor(cigs)
```

Es decir que existe un nivel medio de correlacion negativa entre la cantidad de paquetes de cigarillos consumidos y su precio y una correlacion sumamente debil entre el ingreso per capita y su consumo.

Con el fin de analizar la regresión lineal de nuestras variables, utilizaremos el siguiente codigo:

### 1.2 Regresión Lineal

Con el fin de analizar la regresión lineal de nuestras variables, utilizaremos el siguiente codigo:

```{r, warning = FALSE}
linear.cigs <-lm(PACKS ~ price+income, data=cigs)

stargazer(linear.cigs, type = "text", title = "Cuadro #: Resultados Regresión")
coef = coefficients(linear.cigs)
```

El cual nos muestra que en promedio se consumiria 4.3 paquetes de cigarillos si el precio y los ingresos fueran 0 y por cada unidad porcentual de cambio en el precio de los cigarillos en cada ciudad, se asocia a un cambio negativo de 133% en el promedio de la cantidad de cigarillos consumidos mientras que por cada unidad porcentual de cambio en ingreso disponible per capita se asocia a un cambio de 17.2% en el consumo de cigarillos.

### 1.3 Pruebas t
utilizando la misma función que en la pregunta anterior, se obtiene la información necesaria para obtener los resultados de la prueba t.

Tomando H0: B1=0 (Precio no tiene efecto en consumo) La prueba t realizada para el precio nos devuelve un P-value de 0.000168, es decir un 0.168%, con estos datos podemos rechazar la hipotesis y decir que estadisticamente el precio de los cigarillos tiene un efecto sobre su consumo.

Tomando H0: B2=0 (Ingreso no tiene efecto en consumo) La prueba t realizada para el ingreso nos devuelve un P-Value de 0.386 el cual, en una prueba con un 95% de significancia significaria que la probabilidad de cometer un error tipo 1 es significativamente mayor al 5% y por ello se puede rechazar la hipotesis nula.

### 1.4 Pruebas F

Tomando un H0: B1=B2=0 y al utilizar el codigo de:

Nos da un P-value de prueba F de 0.0004, tomando un α=0.05, llegamos al resultado que se rechaza la hipotesis nula, es decir que las variables "income" y "price" sirven para explicar la variable dependiente de "PACKS", es decir que el precio de los cigarillos y el ingreso per capita de las personas tinen un efecto sobre el consumo promedio de paquetes de cigarillos. \#\# Analisis Energy

### Resumen

```{r}

summary(energy)
```

```{R}

plot(energy)

```

## 3. Analisis Euroenergy

Para esta base de datos se tiene información relevante respecto al consumo de enerergia de 20 paises. Solamente se tienen dos variables numéricas dentro de la base de datos: - *energy*, el consumo agregado de energia en millones de kilogramos equivalentes de Carbon. -*GDP*, el PIB real de cada paiases de 1980 a precios de 1975.

Para este caso, ambas variables tomarán el papel de variable dependiente.

### 3.1 Resumen: Analisis Descriptivo

```{r, echo=FALSE}
table1 = summary(euroenergy)
stargazer(as.data.frame(euroenergy[c("GDP","energy")]), 
          type = "text", 
          title = "Cuadro #: Resumen Euroenergy")
```

Realizando un gráfico de puntos con la variable "energy" como variable dependiente y la variable "GDP" como variable explicativa, puede verse una cierta correlación. Parece ser que, ante incrementos en el GDP, surgen también aumentos en el consumo de energía. En otras palabras, conforme se incrementa el producto, el consumo de energía tiende a la alza (parece que ambas se relacionan positivamente) Lo anterior se demuestra en el siguiente gráfico:

```{r}
euroenergy$GDP_1 = euroenergy$GDP/100000
euroenergy$energy_1 = euroenergy$energy/100000
ggplot( data = euroenergy, 
        mapping = aes(
          x = GDP_1,
          y = energy_1
      )) + geom_point(color = "red") +
  labs( title = "Europa: Nivel del PIB Real y Conusmo de Energía",
        subtitle = "En miles de millones de dolares y miles de millones de kg",
        x = "PIB Real",
        y = "Consumo de Energía"
  )+theme_grey() + scale_radius(3)
```

### 3.2 Regresión Lineal

Definamos los siguientes casos:

*Caso a*: "energy" es la variable dependiente (es el caso a desarrollar)

Se utiliza el siguiente código.

```{r, warning = FALSE}
linear.1 <- lm(energy ~ GDP, data = euroenergy)
stargazer(linear.1, type = "text", title = "Cuadro #: Resultados Regresión")
coef = coefficients(linear.1)
```

El resultado que se obtiene indica que, cuando el GDP es nulo, el consumo de energía es negativo. Por cada unidad adicional de GDP, el consumo de energía se incrementa en 0.78 (aproximadamente). Casi tiene una relación de uno a uno.

*Caso b*: "GDP" es la variable dependiente (definido únicamente para este inciso a fin de determinar, por curiosidad, qué ocurre cuando el GDP es la variable dependiente).

```{r, warning = FALSE}
linear.2 <- lm(GDP ~ energy, data = euroenergy)
stargazer(linear.2, type = "text", title = "Cuadro #: Resultados Regresión")
coef = coefficients(linear.2)
```

Cuando el consumo de energía es nulo, el GDP es positivo. Por cada unidad adicional de energía, el GDP se incrementa en 1.23 aproximadamente.

### 3.3 Pruebas t

Para el caso del intercepto, la probabilidad de que se cumpla la hipótesis nula, es decir, que éste sea cero, es de 0.626, mientras que, para el caso del coeficiente de la única variable explicativa, es muy muy baja. Es decir, que la probabilidad de que éste sea cero es aproximadamente cero para esos niveles de significancia.

### 3.4 Pruebas F

*Prueba F:* Se sigue con el uso de la función "summary(regresion)". Se sabe que la hipótesis nula de la prueba F consiste en que todos los coeficientes de la regresión sean iguales a cero. En el caso de la prueba anterior, se buscaba probar la misma hipótesis pero para cada uno de los coeficientes por aparte, acá se busca probar conjuntamente que éstos sean cero.

Los resultados de la prueba, arrojan que, el F calculado de esta prueba es de 386.3 y tiene 1 y 18 grados de libertad. Se observa también que el P-value es muy próximo a cero, por lo tanto, no se acepta la hipótesis de que todos los coeficientes (conjuntamente) son cero.

### 6. Cuando los datos lo permitan, defina un modelo de regresión lineal como base y realice la prueba F de modelo restringido versus modelo sin restringir e interprete cuál es más adecuado.

Los datos no son suficientes como para elaborar modelos restringidos, puesto que, solamente se tienen dos variables.

## Conclusión
